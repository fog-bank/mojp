<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>mojp - MO 日本語カードテキスト表示ツール</title>
  <meta name="description" content="MO で表示されているカードに対応して、日本語テキストを自動で表示するアプリを公開しています。">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
  <h1 id="top">mojp</h1>
  <ul id="menu">
    <li><a href="#top">TOP</a></li>
    <li><a href="#download">ダウンロード</a></li>
    <li><a href="#howtouse">使い方</a></li>
    <li><a href="#contact">連絡先</a></li>
    <li><a href="https://github.com/fog-bank/mojp">View on GitHub</a></li>
  </ul>
  <div id="content">
    <h2>MO 日本語カードテキスト表示ツール</h2>
    <div>
      <p><a href="http://www.mtgo.com/">Magic: The Gathering Online</a> (MO) で表示されているカードに対応して、日本語テキストを自動で表示するアプリです。</p>
      <div id="grid">
        <div><img id="screenshot" src="images/screenshot.png" width="316" height="253" /></div>
        <div>
          <h4><span class="underline">主な機能</span></h4>
          <ul>
            <li>MO の Preview Pane に表示されているカードの日本語テキストを表示する</li>
            <li>カード名（日本語または英語）をコピーする</li>
            <li><a href="http://mtgwiki.com/">MTG Wiki</a> でカードを調べる</li>
            <li>カードが <a href="http://pdmtgo.com/">Penny Dreadful</a> (PD) で使用可能かどうかを表示する</li>
            <li><a href="https://scryfall.com/">Scryfall</a> から日毎の平均価格を取得する</li>
          </ul>
        </div>
      </div>
    </div>
    <h3 id="download">ダウンロード</h3>
    <div>
      <p>ダウンロード時に、ブラウザやセキュリティソフトからセキュリティ警告が出る場合があります。</p>
      <h4><span class="underline">最新版 v2.9.1</span></h4>
      <p>統率者 2020 の変容カードに対応できていない不具合を修正しました。</p>
      <p>
        <img src="images/download_file.png" width="16" height="16" />
        <a href="https://fog-bank.github.io/mojp/downloads/v2.9.1/mojp.zip">ZIP 版</a> ｜
        <img src="images/clickonce.png" width="16" height="16" />
        <a href="https://github.com/fog-bank/mojp/releases/download/v2.9.1/setup.exe">インストーラー版</a> ｜
        <img src="images/note.png" width="16" height="16" />
        <a href="https://github.com/fog-bank/mojp/releases/tag/v2.9.1">リリースノート</a>
      </p>
      <h4><span class="underline">v2.9.0（イコリア：巨獣の棲処 &amp; 統率者 2020 対応）</span></h4>
      <p>
        <img src="images/note.png" width="16" height="16" />
        <a href="https://github.com/fog-bank/mojp/releases/tag/v2.9.0">リリースノート</a>
      </p>
      <h4><span class="underline">v2.8.0（テーロス還魂記 対応）</span></h4>
      <p>
        <img src="images/note.png" width="16" height="16" />
        <a href="https://github.com/fog-bank/mojp/releases/tag/v2.8.0">リリースノート</a>
      </p>
      <h4><span class="underline">更新履歴</span></h4>
      <p>v2.0.0（基本セット 2019）より、ツールバーをカスタマイズできるようになりました。</p>
      <p>v1.7.0（イクサランの相克）より、カードの追加情報をインターネットから取得するようになりました。不要な場合や処理を軽くしたい場合は、設定から無効にしてください。</p>
      <p>v1.1.0 より、Preview Pane の有無を自動で確認するようになりました。</p>
    </div>
    <h3 id="howtouse">使い方</h3>
    <div>
      <h4><span class="underline">必要条件</span></h4>
      <p>Windows 7 SP1 以降</p>
      <p>.NET Framework 4.6 以上（Windows 10 の場合は標準でインストール済みです）</p>
      <h4><span class="underline">手順</span></h4>
      <ol>
        <li>MO を起動し、COLLECTION 画面や対戦・トレード中に Preview Pane を表示するようにします（最小化しても OK）。</li>
        <li>MO 上で調べたいカードにマウスカーソルを移動させます。Preview Pane にそのカードが表示されます。</li>
        <li>Preview Pane に対応してこのアプリの表示が変わり、そのカードの日本語テキストが表示されます。</li>
      </ol>
      <h4><span class="underline">補足</span></h4>
      <ul>
        <li>
          Preview Pane を表示するには、ACCOUNT 画面の「Display &amp; Sound Settings」内の右下にある「Display Card Preview
          Window」にチェックを入れます。詳細は<a href="https://github.com/fog-bank/mojp/wiki/Preview-Pane-%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%95%E3%81%9B%E3%82%8B%E6%96%B9%E6%B3%95">こちら</a>。
        </li>
        <li>カードをズームしたままマウスカーソルを移動した場合や、素早くマウスカーソルを移動した場合に、表示が変わらないことがあります。</li>
        <li>トークンや紋章などには対応しておらず、何も表示されません。詳細は<a href="https://github.com/fog-bank/mojp/wiki/%E4%B8%8D%E5%85%B7%E5%90%88">こちら</a>。</li>
        <li>あくまで参考程度のご利用でお願い致します。このアプリを原因とする損害には責任を負いかねます。</li>
      </ul>
      <h4><span class="underline">その他の機能</span></h4>
      <ul>
        <li>
          右上のツールバーにある地球アイコンのボタンをクリックすると、<a href="http://mtgwiki.com/wiki/%E3%82%AB%E3%83%BC%E3%83%89%E5%80%8B%E5%88%A5%E8%A9%95%E4%BE%A1">MTG Wiki</a>
          の当該解説ページをブラウザで開きます。ツールバーに表示するボタンは変更可能です。
        </li>
        <li>右クリックメニューから、カード名をコピーしたり、このアプリの設定を変更したりできます。</li>
        <li>
          以下の機能はインターネットにバックグラウンドで接続します。不要な場合は設定から無効にしてください。
          <ul>
            <li>
              起動時に <a href="https://fog-bank.github.io/mojp/">https://fog-bank.github.io/mojp/</a>
              にアクセスして、新しいバージョンがリリースされているかどうかを自動で確認します。ZIP 版の場合はダウンロードまではしません。インストーラー版の場合は自動確認を無効にできません。
            </li>
            <li>起動時に <a href="http://pdmtgo.com/legal_cards.txt">Penny Dreadful のカードリスト</a>をダウンロードします (1 日 1 回まで) 。</li>
            <li>カードを表示するたび <a href="https://scryfall.com/docs/api/cards/search">Scryfall の検索 API</a> にアクセスします (1 秒に 5 枚まで、各カード 1 日 1 回まで) 。</li>
          </ul>
        </li>
      </ul>
      <p>詳しい説明や既知の不具合については <a href="https://github.com/fog-bank/mojp/wiki">GitHub 内の Wiki</a> をご確認ください。</p>
    </div>
    <h3 id="mechanism">仕組み</h3>
    <div>
      <p>
        <a href="https://docs.microsoft.com/ja-jp/dotnet/framework/ui-automation/">UI Automation</a> API を利用して、Preview Pane 内のテキストを検索しています。メインロジックは
        <a href="https://github.com/fog-bank/mojp/blob/master/mojp/AutomationHandler.cs#L53">AutomationHandler.cs</a> 内の CapturePreviewPane メソッド以下です。
      </p>
    </div>
    <h3 id="reference">リファレンス</h3>
    <div>
      <p>MO で日本語テキストを表示する試みとして、<a href="http://www.royalcrab.net/wpx/?page_id=38">Magic Online 日本語化計画</a>の影響を受けています。</p>
      <p>このアプリで表示する日本語テキストは、<a href="http://whisper.wisdom-guild.net/">WHISPER</a> の検索結果をテキストファイルに保存したものに基づいています。</p>
      <p>
        アイコンの一部は Iconfinder の作品 [<a href="https://www.iconfinder.com/icons/6000/book_dictionary_learn_school_translate_icon#size=128">1</a>,
        <a href="https://www.iconfinder.com/icons/285680/camera_icon#size=16">2</a>] を利用しています。
      </p>
      <h4><span class="underline">手動でカードデータを更新する方法</span></h4>
      <ol>
        <li>
          GitHub のリポジトリから <a href="https://github.com/fog-bank/mojp/raw/master/mojp/appendix.xml" type="text/xml">appendix.xml</a>
          （ファイル名固定）をダウンロードして、アプリケーションフォルダ（mojp.exe があるフォルダ）に保存しておく。
        </li>
        <li><a href="http://whisper.wisdom-guild.net/">WHISPER</a>で、次元・現象・計略・策略以外のカードタイプにチェックを入れ、さらに一番下の出力形式をテキストにして検索する。</li>
        <li>表示されたテキストを、エンコード形式を Shift-JIS にして保存する。</li>
        <li>本アプリの設定画面を開き、一番下の開発用メニューから「検索結果テキストの読み込み」ボタンで保存したテキストを読み込む。</li>
        <li>チェックマークが表示されたら完了。アプリケーションフォルダにある cards.xml が変更されているはずです。</li>
      </ol>
      <p>カードセットを絞らない場合、1.8 万件以上のカードがヒットし、テキストのサイズは 6 MB を超えますので、この方法で頻繁に検索しないでください。</p>
    </div>
    <h3 id="contact">連絡先</h3>
    <div>
      <p>Twitter：<a href="https://twitter.com/bank_fog">@bank_fog</a></p>
      <p>ニコ動：<a href="http://www.nicovideo.jp/watch/sm29837666">sm29837666</a></p>
      <p>または、以下のフォームで匿名のコメントが可能です（コメントと名前、仮のメールアドレスを記入後、ゲストとして投稿するにチェック）。なおコメントの承認まで時間がかかる場合があります。</p>
      <div id="comment_body">
        <div id="disqus_thread"></div>
        <noscript><a href="https://disqus.com/?ref_noscript">Disqus を利用したコメント</a>を見るには、JavaScript を有効にしてください。</noscript>
      </div>
    </div>
  </div>
  <script type="application/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script type="application/javascript" src="script.js"></script>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://fog-bank.github.io/mojp/';
      this.page.identifier = 'index';
    };
    (function () {
      var d = document, s = d.createElement('script');
      s.src = 'https://mojp.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
</body>
</html>
